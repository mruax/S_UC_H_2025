{% extends 'base.html' %}

{% block title %}Траектории обучения{% endblock %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px;">
    <div>
        <h1>Траектории обучения</h1>
        <p style="font-size: 18px; color: #86868b;">Личные и преподавательские траектории</p>
    </div>
    <a href="{% url 'create_trajectory' %}" class="btn">+ Создать траекторию</a>
</div>

{% if all_trajectories %}
<h2 style="margin-bottom: 20px;">Ваши траектории</h2>
<div class="grid">
    {% for traj in all_trajectories %}
    <a href="{% url 'trajectory' traj.id %}" style="text-decoration: none; color: inherit;">
        <div class="card" style="cursor: pointer; transition: transform 0.2s;">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                <h3 style="font-size: 18px; margin: 0;">{{ traj.name }}</h3>
                <span style="font-size: 10px; background: {% if traj.trajectory_type == 'personal' %}#000{% else %}#666{% endif %}; color: #fff; padding: 4px 8px; border-radius: 4px;">
                    {% if traj.trajectory_type == 'personal' %}Личная{% else %}От преподавателя{% endif %}
                </span>
            </div>
            <p style="font-size: 12px; color: #86868b;">{{ traj.courses.count }} курсов</p>
            {% if traj.teacher %}
            <p style="font-size: 12px; color: #86868b; margin-top: 8px;">Преподаватель: {{ traj.teacher.username }}</p>
            {% endif %}
        </div>
    </a>
    {% endfor %}
</div>
{% else %}
<div style="text-align: center; padding: 60px 0;">
    <p style="font-size: 18px; color: #86868b; margin-bottom: 20px;">У вас пока нет траекторий</p>
    <a href="{% url 'create_trajectory' %}" class="btn">Создать первую траекторию</a>
</div>
{% endif %}

{% if trajectory %}
<div style="margin-top: 60px;">
    <h2 style="margin-bottom: 20px;">{{ trajectory.name }}</h2>
    
    {% if trajectory_courses %}
    <div style="display: flex; flex-direction: column; gap: 15px;">
        {% for tc in trajectory_courses %}
        <div class="card" style="display: flex; align-items: center; gap: 20px;">
            <div style="min-width: 40px; height: 40px; background: #000; color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600;">
                {{ forloop.counter }}
            </div>
            <div style="flex: 1;">
                <h3 style="font-size: 16px; margin-bottom: 4px;">{{ tc.course.title }}</h3>
                <p style="font-size: 12px; color: #86868b;">{{ tc.course.category }} • {{ tc.course.duration_hours }} часов</p>
            </div>
            <div style="min-width: 120px; text-align: right;">
                <div style="width: 100%; height: 6px; background: #f5f5f7; border-radius: 3px; overflow: hidden;">
                    <div style="width: {{ tc.progress }}%; height: 100%; background: #000; transition: width 0.3s;"></div>
                </div>
                <p style="font-size: 11px; color: #86868b; margin-top: 4px;">{{ tc.progress }}%</p>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p style="color: #86868b;">В траектории пока нет курсов</p>
    {% endif %}
</div>
{% endif %}
{% endblock %}
